{% extends "blog/navbar.html" %}
{% load static %}
{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/posts.css' %}">
{% endblock %}

{% block content %}
<div class="posts-container">
    <h2>All Blog Posts</h2>
    {% if request.GET.q %}
        <p>Search results for: "<strong>{{ request.GET.q }}</strong>"</p>
    {% endif %}

    {% if object_list %}
        <div class="posts-list">
            {% for post in object_list %}
                <div class="post-card">
                    <h3>{{ post.title }}</h3>
                    <p class="author">by {{ post.author.username }} | {{ post.created_at|date:"F j, Y" }}</p>
                    <p class="content">{{ post.content|truncatewords:30 }}</p>

                    {% if post.tags.all %}
                        <p class="tags">
                            Tags:
                            {% for tag in post.tags.all %}
                                <span class="tag">{{ tag.name }}</span>{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                    {% endif %}

                    <a href="{% url 'post-detail' post.pk %}" class="read-more">Read More</a>
                    {% if user == post.author %}
                        <a href="{% url 'post-delete' post.pk %}" class="read-more">Delete</a>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No posts available yet.</p>
    {% endif %}
</div>
{% endblock %}
