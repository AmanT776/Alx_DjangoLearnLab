{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }} | My Blog</title>
    <link rel="stylesheet" href="{% static 'css/post_detail.css' %}">
</head>
<body>

    <div class="container">
        <div class="back-button">
            <a href="{% url 'posts' %}" class="btn-back">‚Üê Back to Posts</a>
        </div>

        <h2 class="post-title">{{ post.title }}</h2>
        <p class="post-body">{{ post.content }}</p>

        {% if post.tags.all %}
            <p class="post-tags">
                Tags:
                {% for tag in post.tags.all %}
                    <a href="{% url 'posts_by_tag' tag.name %}" class="tag">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </p>
        {% endif %}
        <hr>

        <h4>Comments ({{ post.comments.count }})</h4>

        {% for comment in comments %}
            <div class="comment">
                <strong>{{ comment.author.username }}</strong>
                <small>{{ comment.created_at|date:"M d, Y H:i" }}</small>
                <p>{{ comment.content }}</p>

                {% if user == comment.author %}
                    <a href="{% url 'comment_update' comment.pk %}" class="btn btn-outline-primary">Edit</a>
                    <a href="{% url 'comment_delete' comment.pk %}" class="btn btn-outline-danger">Delete</a>
                {% endif %}
            </div>
        {% empty %}
            <p>No comments yet. Be the first to comment!</p>
        {% endfor %}

        <hr>

        {% if user.is_authenticated %}
            <form method="POST" class="comment-form">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn-post">Post Comment</button>
            </form>
        {% else %}
            <div class="login-reminder">
                You must <a href="{% url 'login' %}">login</a> to post a comment.
            </div>
        {% endif %}
    </div>

</body>
</html>
